import{d as Ze,a as A,b as d,s as x,f as b,e as qe}from"../chunks/5jrULABA.js";import{S as Ge,T as g,U as ue,V as Je,$ as _e,Y as l,d as e,W as j,X as Le,Z as n,_ as t,a0 as a,a2 as G,a3 as ye,a1 as $e}from"../chunks/Bu7XKhG-.js";import{i as I}from"../chunks/64S6HLbC.js";import{e as fe,i as he}from"../chunks/D91HFo5I.js";import{s as T,t as Qe,l as es,a as J}from"../chunks/tnJ21aC2.js";import{s as ss}from"../chunks/DvixMhaI.js";import{s as as,a as ts}from"../chunks/Cvp8QKtV.js";import{g as rs}from"../chunks/BAFRKenw.js";import{t as ls,s as L}from"../chunks/gbT3kRQG.js";import{a as os,b as is}from"../chunks/BeKFXwpI.js";import{a as Se}from"../chunks/BXvIZ4AA.js";var ns=b('<span class="phase-check svelte-1xe9j7b">âœ“</span>'),cs=b('<button><span class="phase-num svelte-1xe9j7b"> </span> <!></button>'),vs=b('<div class="loading svelte-1xe9j7b"><div class="spinner svelte-1xe9j7b"></div></div>'),ps=b('<div class="prompt-bubble svelte-1xe9j7b"><span class="prompt-text svelte-1xe9j7b"> </span></div>'),ds=b('<button class="strip-starter svelte-1xe9j7b"><img alt="I want" width="40" height="40" class="svelte-1xe9j7b"/> <span class="svelte-1xe9j7b">I want</span></button>'),bs=b('<button class="strip-starter svelte-1xe9j7b"><img alt="I see" width="40" height="40" class="svelte-1xe9j7b"/><span class="svelte-1xe9j7b">I see</span></button>'),us=b('<button class="strip-starter svelte-1xe9j7b"><img alt="I hear" width="40" height="40" class="svelte-1xe9j7b"/><span class="svelte-1xe9j7b">I hear</span></button>'),_s=b("<!> <!>",1),fs=b('<div class="strip-item svelte-1xe9j7b"><img width="48" height="48" class="svelte-1xe9j7b"/> <span class="svelte-1xe9j7b"> </span></div>'),hs=b('<div class="sentence-strip svelte-1xe9j7b"><!> <!> <div class="strip-items svelte-1xe9j7b"></div> <button class="strip-speak svelte-1xe9j7b"> </button></div>'),xs=b('<div class="partner-area svelte-1xe9j7b"><p class="svelte-1xe9j7b"> </p> <div class="partner-hand svelte-1xe9j7b" role="button" tabindex="0" aria-label="Partner"><span class="svelte-1xe9j7b">ðŸ¤²</span> <p class="svelte-1xe9j7b"> </p></div></div>'),gs=b('<div class="target-hint svelte-1xe9j7b"><span class="svelte-1xe9j7b"> </span> <strong class="svelte-1xe9j7b"> </strong></div>'),js=b('<button class="item-card svelte-1xe9j7b"><img width="72" height="72" class="svelte-1xe9j7b"/> <span class="svelte-1xe9j7b"> </span></button>'),ms=b('<!> <!> <!> <!> <div class="items-grid svelte-1xe9j7b"></div> <div class="score-bar svelte-1xe9j7b"><span class="svelte-1xe9j7b"> </span> <span class="svelte-1xe9j7b"> </span></div>',1),ws=b('<div class="celebration svelte-1xe9j7b"><span class="celebration-emoji svelte-1xe9j7b">ðŸŽ‰</span> <span class="celebration-text svelte-1xe9j7b"> </span></div>'),ks=b(`<div class="pecs-page svelte-1xe9j7b"><header class="app-header svelte-1xe9j7b"><button class="back-btn svelte-1xe9j7b"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" class="svelte-1xe9j7b"><path d="M15 18l-6-6 6-6" class="svelte-1xe9j7b"></path></svg></button> <h1 class="svelte-1xe9j7b"> </h1></header> <div class="phase-bar svelte-1xe9j7b"></div> <p class="phase-desc svelte-1xe9j7b"> </p> <!> <!> <footer class="credit svelte-1xe9j7b">Pictograms: <a href="https://arasaac.org" target="_blank" rel="noopener" class="svelte-1xe9j7b">ARASAAC</a> â€” CC BY-NC-SA 3.0
    Â· Based on PECSÂ® methodology by Frost &amp; Bondy (1994). PECSÂ® is a trademark of Pyramid Educational Consultants.</footer></div>`);function Ws(Ce,Ae){Ge(Ae,!0);const f=()=>ts(Qe,"$t",Me),[Me,Ee]=as();let o=g(1),R=g(ue([])),Q=g(!0),F=g(null),u=g(ue([])),ee=g(!1),U=g(0),V=g(0),z=g(null),se=g(!1),D=g(null),X=g(null),Z=g(null),H=g(ue({}));const xe={1:{label:"pecs.phase1",desc:"pecs.phase1_desc"},2:{label:"pecs.phase2",desc:"pecs.phase2_desc"},3:{label:"pecs.phase3",desc:"pecs.phase3_desc"},4:{label:"pecs.phase4",desc:"pecs.phase4_desc"},5:{label:"pecs.phase5",desc:"pecs.phase5_desc"},6:{label:"pecs.phase6",desc:"pecs.phase6_desc"}},Be=["cookie","ball","juice","car","book","banana","puzzle","swing","bubbles","music","water","apple"],Te=["dog","cat","bird","flower","rain","sun","tree","fish"];Je(()=>{ge(),We()});async function We(){const s=_e(Se);if(s){const r=await os(s,"pecs-trainer");r?.phaseProgress&&l(H,r.phaseProgress,!0)}}async function Oe(){const s=_e(Se);s&&await is(s,"pecs-trainer",{phaseProgress:e(H)})}async function ge(){l(Q,!0);const s=_e(es),p=(e(o)===6?Te:Be).slice(0,e(o)<=2?4:e(o)<=4?8:12),m=s==="sv"?await ls(p):null,y=await Promise.all(p.map(async(h,$)=>{const W=await L(h,"en"),M=m?m[$].sv:h;return W[0]?{id:W[0].id,url:W[0].url,word:M}:null}));if(l(R,y.filter(Boolean),!0),e(o)>=4){const h=await L("I want",s);h[0]&&l(D,{id:h[0].id,url:h[0].url,word:"I want"},!0)}if(e(o)===6){const h=await L("I see",s),$=await L("I hear",s);h[0]&&l(X,{id:h[0].id,url:h[0].url,word:"I see"},!0),$[0]&&l(Z,{id:$[0].id,url:$[0].url,word:"I hear"},!0)}e(o)>=2&&l(z,e(R)[Math.floor(Math.random()*e(R).length)]||null,!0),l(u,[],!0),l(Q,!1)}function Ne(s){$e(U),e(o)===1?Y(s):e(o)===2?(l(F,s,!0),l(se,!0)):e(o)===3?e(z)&&s.word===e(z).word?Y(s):(J(f()("pecs.try_again")),l(z,e(R)[Math.floor(Math.random()*e(R).length)]||null,!0)):e(o)===4?l(u,[...e(u),s],!0):e(o)===5?(l(u,e(D)?[e(D),s]:[s],!0),je(),Y(s)):e(o)===6&&l(u,[...e(u),s],!0)}function ae(s){l(u,[s,...e(u).filter(r=>r.word!==s.word)],!0)}function je(){const s=e(u).map(r=>r.word).join(" ");J(s)}function Re(){e(u).length>0&&(je(),Y(e(u)[e(u).length-1]),l(u,[],!0))}function me(){e(F)&&(Y(e(F)),l(F,null),l(se,!1))}function Y(s){$e(V),e(H)[e(o)]={trials:e(U),successes:e(V)},Oe(),J(s.word+"! "+f()("pecs.great")),l(ee,!0),setTimeout(()=>{l(ee,!1)},1500)}function ze(s){l(o,s,!0),l(U,0),l(V,0),ge()}var te=ks(),re=t(te),le=t(re),we=n(le,2),De=t(we);a(we),a(re);var oe=n(re,2);fe(oe,20,()=>[1,2,3,4,5,6],he,(s,r)=>{var p=cs();let m;var y=t(p),h=t(y,!0);a(y);var $=n(y,2);{var W=M=>{var ne=ns();d(M,ne)};I($,M=>{e(H)[r]?.successes>=5&&M(W)})}a(p),j(()=>{m=ss(p,1,"phase-btn svelte-1xe9j7b",null,m,{active:e(o)===r,completed:e(H)[r]?.successes>=5}),x(h,r)}),A("click",p,()=>ze(r)),d(s,p)}),a(oe);var ie=n(oe,2),Fe=t(ie,!0);a(ie);var ke=n(ie,2);{var He=s=>{var r=vs();d(s,r)},Ye=s=>{var r=ms(),p=ye(r);{var m=c=>{var i=ps(),v=t(i),w=t(v);a(v),a(i),j(_=>x(w,`â“ ${_??""}`),[()=>f()("pecs.what_want")]),d(c,i)};I(p,c=>{e(o)===5&&c(m)})}var y=n(p,2);{var h=c=>{var i=hs(),v=t(i);{var w=k=>{var P=ds(),B=t(P);G(2),a(P),j(()=>T(B,"src",e(D).url)),A("click",P,()=>ae(e(D))),d(k,P)};I(v,k=>{e(o)===4&&e(D)&&k(w)})}var _=n(v,2);{var E=k=>{var P=_s(),B=ye(P);{var K=N=>{var C=bs(),be=t(C);G(),a(C),j(()=>T(be,"src",e(X).url)),A("click",C,()=>ae(e(X))),d(N,C)};I(B,N=>{e(X)&&N(K)})}var q=n(B,2);{var de=N=>{var C=us(),be=t(C);G(),a(C),j(()=>T(be,"src",e(Z).url)),A("click",C,()=>ae(e(Z))),d(N,C)};I(q,N=>{e(Z)&&N(de)})}d(k,P)};I(_,k=>{e(o)===6&&k(E)})}var O=n(_,2);fe(O,21,()=>e(u),he,(k,P)=>{var B=fs(),K=t(B),q=n(K,2),de=t(q,!0);a(q),a(B),j(()=>{T(K,"src",e(P).url),T(K,"alt",e(P).word),x(de,e(P).word)}),d(k,B)}),a(O);var S=n(O,2),pe=t(S);a(S),a(i),j(k=>{S.disabled=e(u).length===0,x(pe,`ðŸ”Š ${k??""}`)},[()=>f()("talk.speak_all")]),A("click",S,Re),d(c,i)};I(y,c=>{e(o)>=4&&c(h)})}var $=n(y,2);{var W=c=>{var i=xs(),v=t(i),w=t(v,!0);a(v);var _=n(v,2),E=n(t(_),2),O=t(E,!0);a(E),a(_),a(i),j((S,pe)=>{x(w,S),x(O,pe)},[()=>f()("pecs.bring_to_partner"),()=>f()("pecs.tap_to_give")]),A("click",_,me),A("keydown",_,S=>{(S.key==="Enter"||S.key===" ")&&me()}),d(c,i)};I($,c=>{e(o)===2&&e(se)&&e(F)&&c(W)})}var M=n($,2);{var ne=c=>{var i=gs(),v=t(i),w=t(v);a(v);var _=n(v,2),E=t(_,!0);a(_),a(i),j(O=>{x(w,`${O??""}:`),x(E,e(z).word)},[()=>f()("pecs.find")]),d(c,i)};I(M,c=>{e(o)===3&&e(z)&&c(ne)})}var ce=n(M,2);fe(ce,21,()=>e(R),he,(c,i)=>{var v=js(),w=t(v),_=n(w,2),E=t(_,!0);a(_),a(v),j(()=>{T(w,"src",e(i).url),T(w,"alt",e(i).word),x(E,e(i).word)}),A("click",v,()=>Ne(e(i))),qe("focus",v,()=>J(e(i).word)),d(c,v)}),a(ce);var Pe=n(ce,2),ve=t(Pe),Ve=t(ve);a(ve);var Ie=n(ve,2),Xe=t(Ie);a(Ie),a(Pe),j((c,i)=>{x(Ve,`${c??""}: ${e(U)??""}`),x(Xe,`${i??""}: ${e(V)??""}`)},[()=>f()("pecs.trials"),()=>f()("pecs.correct")]),d(s,r)};I(ke,s=>{e(Q)?s(He):s(Ye,!1)})}var Ke=n(ke,2);{var Ue=s=>{var r=ws(),p=n(t(r),2),m=t(p,!0);a(p),a(r),j(y=>x(m,y),[()=>f()("pecs.great")]),d(s,r)};I(Ke,s=>{e(ee)&&s(Ue)})}G(2),a(te),j((s,r,p,m)=>{T(le,"aria-label",s),x(De,`${r??""} â€” ${p??""}`),x(Fe,m)},[()=>f()("app.back"),()=>f()("pecs.title"),()=>f()(xe[e(o)].label),()=>f()(xe[e(o)].desc)]),A("click",le,()=>rs("/")),d(Ce,te),Le(),Ee()}Ze(["click","keydown"]);export{Ws as component};
