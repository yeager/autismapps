import{d as Ie,a as p,b as _,s as v,f as h,g as Ve}from"../chunks/5jrULABA.js";import{S as De,T as R,U as Le,V as Ne,Y as r,W as S,X as Oe,_ as t,Z as s,a0 as a,d as e,a3 as Ue}from"../chunks/Bu7XKhG-.js";import{i as W}from"../chunks/64S6HLbC.js";import{e as X,i as B}from"../chunks/D91HFo5I.js";import{t as Y,a as le,f as de}from"../chunks/BufHwZ1v.js";import{a as se,t as We,r as ue,s as Xe}from"../chunks/tnJ21aC2.js";import{s as ie}from"../chunks/DvixMhaI.js";import{b as me}from"../chunks/BHAKTja7.js";import{s as Ye,a as Ze}from"../chunks/Cvp8QKtV.js";import{g as qe}from"../chunks/BAFRKenw.js";import{h as ze,i as Be,v as Fe}from"../chunks/BeKFXwpI.js";import{a as Ge,b as Je}from"../chunks/BXvIZ4AA.js";var Ke=h('<span class="pin-icon svelte-hmkf6r">ðŸ”’</span>'),Me=h('<button class="profile-card svelte-hmkf6r"><span class="profile-avatar svelte-hmkf6r"> </span> <span class="profile-name svelte-hmkf6r"> </span> <!></button>'),Qe=h("<div></div>"),ea=h('<p class="pin-error svelte-hmkf6r"> </p>'),aa=h("<div></div>"),ta=h('<button class="numpad-btn svelte-hmkf6r">âŒ«</button>'),ra=h('<button class="numpad-btn svelte-hmkf6r"> </button>'),la=h('<div class="overlay svelte-hmkf6r" role="button" tabindex="-1"><div class="pin-dialog svelte-hmkf6r" role="dialog" aria-modal="true" tabindex="-1"><h2 class="svelte-hmkf6r"> </h2> <div class="pin-dots svelte-hmkf6r"></div> <!> <div class="numpad svelte-hmkf6r"></div> <button class="cancel-btn svelte-hmkf6r"> </button></div></div>'),sa=h("<button> </button>"),ia=h("<button><span> </span> </button>"),oa=h('<div class="overlay svelte-hmkf6r" role="button" tabindex="-1"><div class="create-dialog svelte-hmkf6r" role="dialog" aria-modal="true" tabindex="-1"><h2 class="svelte-hmkf6r"> </h2> <label class="field-label svelte-hmkf6r" for="profile-name"> </label> <input id="profile-name" type="text" class="text-input svelte-hmkf6r"/> <span class="field-label svelte-hmkf6r" id="avatar-label"> </span> <div class="avatar-grid svelte-hmkf6r"></div> <span class="field-label svelte-hmkf6r" id="role-label"> </span> <div class="role-grid svelte-hmkf6r"></div> <label class="field-label svelte-hmkf6r" for="profile-pin"> </label> <input id="profile-pin" type="password" maxlength="4" pattern="[0-9]*" inputmode="numeric" placeholder="â€¢â€¢â€¢â€¢" class="text-input pin-field svelte-hmkf6r"/> <div class="dialog-actions svelte-hmkf6r"><button class="cancel-btn svelte-hmkf6r"> </button> <button class="create-btn svelte-hmkf6r"> </button></div></div></div>'),na=h('<div class="profiles-page svelte-hmkf6r"><h1 class="svelte-hmkf6r"> </h1> <p class="subtitle svelte-hmkf6r"> </p> <div class="profile-grid svelte-hmkf6r"><!> <button class="profile-card new-card svelte-hmkf6r"><span class="profile-avatar svelte-hmkf6r">âž•</span> <span class="profile-name svelte-hmkf6r"> </span></button></div> <!> <!></div>');function xa(_e,he){De(he,!0);const f=()=>Ze(We,"$t",be),[be,ke]=Ye();let oe=R(Le([])),I=R(!1),V=R(""),Z=R("ðŸ˜Š"),q=R(""),F=R("child"),x=R(""),A=R(null),G=R(!1);const ge=["ðŸ˜Š","ðŸ¦Š","ðŸ»","ðŸ¦","ðŸ¸","ðŸŒŸ","ðŸ¦‹","ðŸ¢","ðŸ°","ðŸ¦‰","ðŸ±","ðŸ¶","ðŸŒˆ","ðŸš€","ðŸŽ¨","ðŸŽµ"],xe=[{id:"child",label:"profile.role.child",emoji:"ðŸ‘§"},{id:"parent",label:"profile.role.parent",emoji:"ðŸ‘ª"},{id:"teacher",label:"profile.role.teacher",emoji:"ðŸ‘©â€ðŸ«"},{id:"therapist",label:"profile.role.therapist",emoji:"ðŸ—£ï¸"}];Ne(()=>{ne()});async function ne(){r(oe,await ze(),!0)}async function we(l){l.pinHash?(r(A,l,!0),r(x,""),r(G,!1)):ve(l)}function ve(l){Ge.set(l.id),Je.set(l),se(f()("profile.welcome")+" "+l.name),qe("/")}async function ye(){if(!e(A))return;await Fe(e(A).id,e(x))?(ve(e(A)),r(A,null)):(r(G,!0),r(x,""),se(f()("profile.wrong_pin")))}function Pe(l){e(x).length<4&&(r(x,e(x)+l),e(x).length===4&&ye())}async function Ae(){e(V).trim()&&(await Be(e(V).trim(),e(Z),e(q)||void 0),r(V,""),r(Z,"ðŸ˜Š"),r(q,""),r(F,"child"),r(I,!1),await ne())}var J=na(),K=t(J),Ee=t(K,!0);a(K);var M=s(K,2),je=t(M,!0);a(M);var Q=s(M,2),fe=t(Q);X(fe,17,()=>e(oe),l=>l.id,(l,i)=>{var o=Me(),b=t(o),O=t(b,!0);a(b);var k=s(b,2),D=t(k,!0);a(k);var T=s(k,2);{var E=j=>{var $=Ke();_(j,$)};W(T,j=>{e(i).pinHash&&j(E)})}a(o),S(()=>{v(O,e(i).avatar),v(D,e(i).name)}),p("click",o,()=>we(e(i))),Y(3,o,()=>le,()=>({y:20})),_(l,o)});var ee=s(fe,2),pe=s(t(ee),2),Re=t(pe,!0);a(pe),a(ee),a(Q);var ce=s(Q,2);{var Se=l=>{var i=la(),o=t(i),b=t(o),O=t(b,!0);a(b);var k=s(b,2);X(k,20,()=>Array(4),B,(n,u,w)=>{var y=Qe();let L;S(()=>L=ie(y,1,"dot svelte-hmkf6r",null,L,{filled:w<e(x).length})),_(n,y)}),a(k);var D=s(k,2);{var T=n=>{var u=ea(),w=t(u,!0);a(u),S(y=>v(w,y),[()=>f()("profile.wrong_pin")]),_(n,u)};W(D,n=>{e(G)&&n(T)})}var E=s(D,2);X(E,20,()=>["1","2","3","4","5","6","7","8","9","","0","âŒ«"],B,(n,u)=>{var w=Ve(),y=Ue(w);{var L=d=>{var g=aa();_(d,g)},U=d=>{var g=ta();p("click",g,()=>{r(x,e(x).slice(0,-1),!0)}),_(d,g)},z=d=>{var g=ra(),N=t(g,!0);a(g),S(()=>v(N,u)),p("click",g,()=>Pe(u)),_(d,g)};W(y,d=>{u===""?d(L):u==="âŒ«"?d(U,1):d(z,!1)})}_(n,w)}),a(E);var j=s(E,2),$=t(j,!0);a(j),a(o),a(i),S((n,u)=>{v(O,n),v($,u)},[()=>f()("profile.enter_pin"),()=>f()("app.back")]),p("click",i,()=>{r(A,null)}),p("keydown",i,n=>{n.key==="Escape"&&r(A,null)}),p("click",o,n=>n.stopPropagation()),p("keydown",o,n=>n.stopPropagation()),p("click",j,()=>{r(A,null)}),Y(3,o,()=>le,()=>({y:30})),Y(3,i,()=>de),_(l,i)};W(ce,l=>{e(A)&&l(Se)})}var Te=s(ce,2);{var $e=l=>{var i=oa(),o=t(i),b=t(o),O=t(b,!0);a(b);var k=s(b,2),D=t(k,!0);a(k);var T=s(k,2);ue(T);var E=s(T,2),j=t(E,!0);a(E);var $=s(E,2);X($,21,()=>ge,B,(c,P)=>{var m=sa();let C;var H=t(m,!0);a(m),S(()=>{C=ie(m,1,"avatar-pick svelte-hmkf6r",null,C,{selected:e(Z)===e(P)}),v(H,e(P))}),p("click",m,()=>{r(Z,e(P),!0)}),_(c,m)}),a($);var n=s($,2),u=t(n,!0);a(n);var w=s(n,2);X(w,21,()=>xe,B,(c,P)=>{var m=ia();let C;var H=t(m),ae=t(H,!0);a(H);var te=s(H);a(m),S(re=>{C=ie(m,1,"role-pick svelte-hmkf6r",null,C,{selected:e(F)===e(P).id}),v(ae,e(P).emoji),v(te,` ${re??""}`)},[()=>f()(e(P).label)]),p("click",m,()=>{r(F,e(P).id,!0)}),_(c,m)}),a(w);var y=s(w,2),L=t(y,!0);a(y);var U=s(y,2);ue(U);var z=s(U,2),d=t(z),g=t(d,!0);a(d);var N=s(d,2),Ce=t(N,!0);a(N),a(z),a(o),a(i),S((c,P,m,C,H,ae,te,re,He)=>{v(O,c),v(D,P),Xe(T,"placeholder",m),v(j,C),v(u,H),v(L,ae),v(g,te),N.disabled=re,v(Ce,He)},[()=>f()("profile.new"),()=>f()("profile.name"),()=>f()("profile.name_placeholder"),()=>f()("profile.avatar"),()=>f()("profile.role"),()=>f()("profile.pin_optional"),()=>f()("app.back"),()=>!e(V).trim(),()=>f()("profile.create")]),p("click",i,()=>{r(I,!1)}),p("keydown",i,c=>{c.key==="Escape"&&r(I,!1)}),p("click",o,c=>c.stopPropagation()),p("keydown",o,c=>c.stopPropagation()),me(T,()=>e(V),c=>r(V,c)),me(U,()=>e(q),c=>r(q,c)),p("click",d,()=>{r(I,!1)}),p("click",N,Ae),Y(3,o,()=>le,()=>({y:30})),Y(3,i,()=>de),_(l,i)};W(Te,l=>{e(I)&&l($e)})}a(J),S((l,i,o)=>{v(Ee,l),v(je,i),v(Re,o)},[()=>f()("profile.choose"),()=>f()("profile.choose_desc"),()=>f()("profile.new")]),p("click",ee,()=>{r(I,!0),se(f()("profile.new"))}),_(_e,J),Oe(),ke()}Ie(["click","keydown"]);export{xa as component};
