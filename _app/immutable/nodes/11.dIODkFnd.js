import{d as ct,a as b,b as m,s as _,f}from"../chunks/Rl5oAaZp.js";import{ag as it,ao as w,b as da,ap as lt,a,s as i,aq as Ba,an as va,ah as z,ai as nt,ak as l,aj as r,al as s,am as dt,as as vt}from"../chunks/5-o2xn5F.js";import{i as B}from"../chunks/CV8532PG.js";import{e as aa,i as ma}from"../chunks/CWjGmADL.js";import{t as xa,f as Ua}from"../chunks/CYPR1nOs.js";import{s as y,r as Sa}from"../chunks/mnwxxtgv.js";import{s as Aa}from"../chunks/tEQK-CCT.js";import{s as fa}from"../chunks/CttGtDdq.js";import{b as Ca}from"../chunks/Ch1I3Fei.js";import{s as mt,a as ft}from"../chunks/1mwIFy_z.js";import{g as pt}from"../chunks/C7HAlxDp.js";import{W as ut}from"../chunks/BIf6fDbj.js";import{t as bt,l as Ia}from"../chunks/D-IBFiEI.js";import{s as Pa}from"../chunks/TeHBZhWf.js";import{s as pa}from"../chunks/gbT3kRQG.js";var _t=f('<button class="icon-btn svelte-zoafqq">üì§</button> <button class="icon-btn svelte-zoafqq">üì•</button>',1),qt=f('<img width="40" height="40" class="svelte-zoafqq"/>'),gt=f('<button class="strip-card svelte-zoafqq"><!> <span class="svelte-zoafqq"> </span></button>'),ht=f('<section class="strip-area svelte-zoafqq"><div class="strip svelte-zoafqq"></div> <div class="strip-btns svelte-zoafqq"><button class="speak-btn svelte-zoafqq">üîä</button> <button class="clear-btn svelte-zoafqq">‚úï</button></div></section>'),kt=f('<button role="tab"><span class="tab-icon svelte-zoafqq"> </span> <span class="tab-name svelte-zoafqq"> </span></button>'),zt=f('<div class="loading svelte-zoafqq"> </div>'),yt=f('<img width="80" height="80" loading="lazy" class="svelte-zoafqq"/>'),wt=f('<button class="remove-btn svelte-zoafqq">‚úï</button>'),Bt=f('<div class="comm-card-wrap svelte-zoafqq"><button class="comm-card svelte-zoafqq"><!> <span class="card-label svelte-zoafqq"> </span></button> <!></div>'),xt=f('<button class="add-card-btn svelte-zoafqq"><span class="add-icon svelte-zoafqq">+</span> <span> </span></button>'),Ut=f('<p class="empty-hint svelte-zoafqq"> </p>'),St=f('<button class="search-result svelte-zoafqq"><img width="56" height="56" class="svelte-zoafqq"/> <span class="svelte-zoafqq"> </span></button>'),At=f('<div class="search-grid svelte-zoafqq"></div>'),Ct=f('<section class="add-panel svelte-zoafqq"><h3 class="svelte-zoafqq"> </h3> <div class="add-option svelte-zoafqq"><h4 class="svelte-zoafqq"> </h4> <div class="search-row svelte-zoafqq"><input class="svelte-zoafqq"/> <button class="svelte-zoafqq"> </button></div> <!></div> <div class="add-option svelte-zoafqq"><h4 class="svelte-zoafqq"> </h4> <input class="svelte-zoafqq"/> <button class="photo-btn svelte-zoafqq"> </button></div></section>'),It=f('<section class="card-grid svelte-zoafqq" role="tabpanel"><!> <!> <!></section> <!>',1),Pt=f('<!> <div class="app svelte-zoafqq"><header class="hdr svelte-zoafqq"><button class="back svelte-zoafqq">‚Üê</button> <h1 class="svelte-zoafqq"> </h1> <div class="hdr-actions svelte-zoafqq"><button>‚úèÔ∏è</button> <!></div></header> <main class="cnt svelte-zoafqq"><!> <nav class="tabs svelte-zoafqq" role="tablist"></nav> <!></main> <footer class="cr svelte-zoafqq"><p>ARASAAC (CC BY-NC-SA) ¬∑ Autismappar</p></footer></div>',1);function Ht($a,Ra){it(Ra,!0);const q=()=>ft(bt,"$t",Ea),[Ea,Oa]=mt(),Da=[{id:"favorites",name:"commBook.page.favorites",icon:"‚≠ê",color:"#F1C40F",cards:[]},{id:"food",name:"commBook.page.food",icon:"üçé",color:"#E67E22",cards:[]},{id:"drinks",name:"commBook.page.drinks",icon:"ü•§",color:"#3498DB",cards:[]},{id:"activities",name:"commBook.page.activities",icon:"üéÆ",color:"#27AE60",cards:[]},{id:"places",name:"commBook.page.places",icon:"üè†",color:"#9B59B6",cards:[]},{id:"people",name:"commBook.page.people",icon:"üë®‚Äçüë©‚Äçüëß‚Äçüë¶",color:"#E74C3C",cards:[]},{id:"feelings",name:"commBook.page.feelings",icon:"üòä",color:"#1ABC9C",cards:[]}],ua={food:["apple","banana","bread","rice","chicken","pasta","egg","cheese","soup","pizza","fish","yogurt"],drinks:["water","milk","juice","tea","smoothie","hot chocolate"],activities:["play","draw","read","sing","swim","run","dance","watch TV","computer","playground","walk","sleep"],places:["home","school","park","store","hospital","bathroom","kitchen","bedroom","car","bus"],people:["mom","dad","brother","sister","teacher","friend","grandma","grandpa","doctor"],feelings:["happy","sad","angry","tired","scared","excited","hungry","thirsty","sick","calm"]};let d=w(da(ja())),P=w("favorites"),x=w(da([])),ta=w(!1),A=w(!1),$=w(!1),Y=w(""),J=w(""),H=w(da([])),M=w(!1);const Q=vt(()=>a(d).find(t=>t.id===a(P))||a(d)[0]);function ja(){try{const t=localStorage.getItem("comm-book-pages");if(t)return JSON.parse(t)}catch{}return Da}function E(){localStorage.setItem("comm-book-pages",JSON.stringify(a(d)))}lt(()=>{a(d).some(e=>e.id!=="favorites"&&e.cards.length===0&&ua[e.id])&&La()});async function La(){i(ta,!0);for(const t of a(d)){if(t.id==="favorites"||t.cards.length>0)continue;const e=ua[t.id];e&&(t.cards=await Promise.all(e.map(async o=>{const c=await pa(o,"en"),p=await pa(o,"sv");return{id:crypto.randomUUID(),label:Ba(Ia)==="sv"&&p[0]?.keyword||o,pictogramUrl:c[0]?.url||"",pictogramId:c[0]?.id||0,isPhoto:!1}})))}i(d,[...a(d)],!0),E(),i(ta,!1)}function Na(t){if(a(A))return;Pa(t.label),i(x,[...a(x),t],!0);const e=a(d).find(o=>o.id==="favorites");if(e&&!e.cards.some(o=>o.label===t.label)){const o=JSON.parse(localStorage.getItem("comm-book-taps")||"{}");o[t.label]=(o[t.label]||0)+1,localStorage.setItem("comm-book-taps",JSON.stringify(o)),o[t.label]>=3&&e.cards.length<12&&(e.cards=[...e.cards,{...t,id:crypto.randomUUID()}],i(d,[...a(d)],!0),E())}}function Ja(){a(x).length>0&&Pa(a(x).map(t=>t.label).join(" "))}function Fa(){i(x,[],!0)}function Ka(t){i(x,a(x).filter((e,o)=>o!==t),!0)}function Ta(t){const e=a(d).find(o=>o.id===a(P));e&&(e.cards=e.cards.filter(o=>o.id!==t),i(d,[...a(d)],!0),E())}async function ba(){if(!a(J).trim())return;i(M,!0);const t=await pa(a(J),Ba(Ia));i(H,t.slice(0,12),!0),i(M,!1)}function Wa(t){const e=a(d).find(o=>o.id===a(P));e&&(e.cards=[...e.cards,{id:crypto.randomUUID(),label:t.keyword,pictogramUrl:t.url,pictogramId:t.id,isPhoto:!1}],i(d,[...a(d)],!0),E(),i($,!1),i(J,""),i(H,[],!0))}function Ga(){const t=document.createElement("input");t.type="file",t.accept="image/*",t.capture="environment",t.onchange=async()=>{const e=t.files?.[0];if(!e)return;const o=new FileReader;o.onload=()=>{const c=a(d).find(p=>p.id===a(P));if(c){const p=a(Y)||e.name.replace(/\.\w+$/,"");c.cards=[...c.cards,{id:crypto.randomUUID(),label:p,pictogramUrl:o.result,pictogramId:0,isPhoto:!0}],i(d,[...a(d)],!0),E(),i($,!1),i(Y,"")}},o.readAsDataURL(e)},t.click()}function Ya(){const t=JSON.stringify(a(d),null,2),e=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(e),c=document.createElement("a");c.href=o,c.download="comm-book.json",c.click(),URL.revokeObjectURL(o)}function Ha(){const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=async()=>{const e=t.files?.[0];if(!e)return;const o=await e.text();try{const c=JSON.parse(o);Array.isArray(c)&&(i(d,c,!0),E())}catch{alert("Invalid file")}},t.click()}var _a=Pt(),qa=va(_a);ut(qa,{appId:"comm-book",titleKey:"app.comm_book",purposeKey:"welcome.commBook.purpose",howKey:"welcome.commBook.how",goalKey:"welcome.commBook.goal",icon:"üìñ"});var ea=l(qa,2),oa=r(ea),sa=r(oa),ra=l(sa,2),Ma=r(ra);s(ra);var ga=l(ra,2),V=r(ga);let ha;var Qa=l(V,2);{var Va=t=>{var e=_t(),o=va(e),c=l(o,2);b("click",o,Ya),b("click",c,Ha),m(t,e)};B(Qa,t=>{a(A)&&t(Va)})}s(ga),s(oa);var ka=l(oa,2),za=r(ka);{var Xa=t=>{var e=ht(),o=r(e);aa(o,21,()=>a(x),ma,(O,C,K)=>{var D=gt(),v=r(D);{var n=h=>{var U=qt();z(()=>{y(U,"src",a(C).pictogramUrl),y(U,"alt",a(C).label)}),m(h,U)};B(v,h=>{a(C).pictogramUrl&&h(n)})}var u=l(v,2),g=r(u,!0);s(u),s(D),z(()=>_(g,a(C).label)),b("click",D,()=>Ka(K)),m(O,D)}),s(o);var c=l(o,2),p=r(c),F=l(p,2);s(c),s(e),b("click",p,Ja),b("click",F,Fa),m(t,e)};B(za,t=>{a(x).length>0&&t(Xa)})}var ca=l(za,2);aa(ca,21,()=>a(d),ma,(t,e)=>{var o=kt();let c;var p=r(o),F=r(p,!0);s(p);var O=l(p,2),C=r(O,!0);s(O),s(o),z(K=>{c=Aa(o,1,"tab svelte-zoafqq",null,c,{active:a(P)===a(e).id}),fa(o,`--tab-color: ${a(e).color??""}`),y(o,"aria-selected",a(P)===a(e).id),_(F,a(e).icon),_(C,K)},[()=>q()(a(e).name)]),b("click",o,()=>{i(P,a(e).id,!0),i($,!1)}),m(t,o)}),s(ca);var Za=l(ca,2);{var at=t=>{var e=zt(),o=r(e);s(e),z(c=>_(o,`‚è≥ ${c??""}`),[()=>q()("commBook.loading")]),m(t,e)},tt=t=>{var e=It(),o=va(e),c=r(o);aa(c,17,()=>a(Q).cards,v=>v.id,(v,n)=>{var u=Bt(),g=r(u),h=r(g);{var U=S=>{var I=yt();z(()=>{y(I,"src",a(n).pictogramUrl),y(I,"alt",a(n).label)}),m(S,I)};B(h,S=>{a(n).pictogramUrl&&S(U)})}var X=l(h,2),T=r(X,!0);s(X),s(g);var R=l(g,2);{var j=S=>{var I=wt();b("click",I,()=>Ta(a(n).id)),m(S,I)};B(R,S=>{a(A)&&S(j)})}s(u),z(()=>{fa(g,`border-color: ${a(Q).color??""}`),_(T,a(n).label)}),b("click",g,()=>Na(a(n))),m(v,u)});var p=l(c,2);{var F=v=>{var n=xt(),u=l(r(n),2),g=r(u,!0);s(u),s(n),z(h=>{fa(n,`border-color: ${a(Q).color??""}`),_(g,h)},[()=>q()("commBook.addCard")]),b("click",n,()=>i($,!a($))),m(v,n)};B(p,v=>{a(A)&&v(F)})}var O=l(p,2);{var C=v=>{var n=Ut(),u=r(n,!0);s(n),z(g=>_(u,g),[()=>q()("commBook.emptyHint")]),m(v,n)};B(O,v=>{a(Q).cards.length===0&&!a(A)&&v(C)})}s(o);var K=l(o,2);{var D=v=>{var n=Ct(),u=r(n),g=r(u,!0);s(u);var h=l(u,2),U=r(h),X=r(U);s(U);var T=l(U,2),R=r(T);Sa(R);var j=l(R,2),S=r(j,!0);s(j),s(T);var I=l(T,2);{var et=k=>{var W=At();aa(W,21,()=>a(H),ma,(na,L)=>{var N=St(),G=r(N),wa=l(G,2),rt=r(wa,!0);s(wa),s(N),z(()=>{y(G,"src",a(L).url),y(G,"alt",a(L).keyword),_(rt,a(L).keyword)}),b("click",N,()=>Wa(a(L))),m(na,N)}),s(W),m(k,W)};B(I,k=>{a(H).length>0&&k(et)})}s(h);var ya=l(h,2),ia=r(ya),ot=r(ia);s(ia);var Z=l(ia,2);Sa(Z);var la=l(Z,2),st=r(la);s(la),s(ya),s(n),z((k,W,na,L,N,G)=>{_(g,k),_(X,`üîç ${W??""}`),y(R,"placeholder",na),j.disabled=a(M),_(S,a(M)?"‚è≥":"üîç"),_(ot,`üì∏ ${L??""}`),y(Z,"placeholder",N),_(st,`üì∑ ${G??""}`)},[()=>q()("commBook.addCard"),()=>q()("commBook.searchArasaac"),()=>q()("commBook.searchPlaceholder"),()=>q()("commBook.addPhoto"),()=>q()("commBook.photoLabel"),()=>q()("commBook.takePhoto")]),b("keydown",R,k=>{k.key==="Enter"&&ba()}),Ca(R,()=>a(J),k=>i(J,k)),b("click",j,ba),Ca(Z,()=>a(Y),k=>i(Y,k)),b("click",la,Ga),xa(1,n,()=>Ua),m(v,n)};B(K,v=>{a($)&&v(D)})}m(t,e)};B(Za,t=>{a(ta)?t(at):t(tt,!1)})}s(ka),dt(2),s(ea),z((t,e,o)=>{y(sa,"aria-label",t),_(Ma,`üìñ ${e??""}`),ha=Aa(V,1,"icon-btn svelte-zoafqq",null,ha,{active:a(A)}),y(V,"aria-label",o)},[()=>q()("app.back"),()=>q()("commBook.title"),()=>q()("commBook.edit")]),b("click",sa,()=>pt("/")),b("click",V,()=>{i(A,!a(A)),i($,!1)}),xa(1,ea,()=>Ua),m($a,_a),nt(),Oa()}ct(["click","keydown"]);export{Ht as component};
