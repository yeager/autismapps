import{d as Ue,a as A,b as d,s as x,f as u,e as Ve}from"../chunks/Rl5oAaZp.js";import{ag as Xe,ao as g,b as ue,ap as Ze,aq as be,s as l,a as e,an as _e,ah as m,ai as es,ak as n,aj as t,al as a,am as U,ar as Se}from"../chunks/5-o2xn5F.js";import{i as y}from"../chunks/CV8532PG.js";import{e as fe,i as he}from"../chunks/CWjGmADL.js";import{s as W}from"../chunks/mnwxxtgv.js";import{s as ss}from"../chunks/tEQK-CCT.js";import{s as as,a as ts}from"../chunks/1mwIFy_z.js";import{g as rs}from"../chunks/C7HAlxDp.js";import{W as ls}from"../chunks/BIf6fDbj.js";import{t as os,l as is}from"../chunks/D-IBFiEI.js";import{s as V}from"../chunks/TeHBZhWf.js";import{t as ns,s as X}from"../chunks/gbT3kRQG.js";import{a as cs,b as vs}from"../chunks/B5a8mNDb.js";import{a as Ae}from"../chunks/CCIDKU4D.js";var ps=u('<span class="phase-check svelte-1xe9j7b">âœ“</span>'),ds=u('<button><span class="phase-num svelte-1xe9j7b"> </span> <!></button>'),us=u('<div class="loading svelte-1xe9j7b"><div class="spinner svelte-1xe9j7b"></div></div>'),bs=u('<div class="prompt-bubble svelte-1xe9j7b"><span class="prompt-text svelte-1xe9j7b"> </span></div>'),_s=u('<button class="strip-starter svelte-1xe9j7b"><img alt="I want" width="40" height="40" class="svelte-1xe9j7b"/> <span class="svelte-1xe9j7b">I want</span></button>'),fs=u('<button class="strip-starter svelte-1xe9j7b"><img alt="I see" width="40" height="40" class="svelte-1xe9j7b"/><span class="svelte-1xe9j7b">I see</span></button>'),hs=u('<button class="strip-starter svelte-1xe9j7b"><img alt="I hear" width="40" height="40" class="svelte-1xe9j7b"/><span class="svelte-1xe9j7b">I hear</span></button>'),xs=u("<!> <!>",1),gs=u('<div class="strip-item svelte-1xe9j7b"><img width="48" height="48" class="svelte-1xe9j7b"/> <span class="svelte-1xe9j7b"> </span></div>'),ms=u('<div class="sentence-strip svelte-1xe9j7b"><!> <!> <div class="strip-items svelte-1xe9j7b"></div> <button class="strip-speak svelte-1xe9j7b"> </button></div>'),js=u('<div class="partner-area svelte-1xe9j7b"><p class="svelte-1xe9j7b"> </p> <div class="partner-hand svelte-1xe9j7b" role="button" tabindex="0" aria-label="Partner"><span class="svelte-1xe9j7b">ðŸ¤²</span> <p class="svelte-1xe9j7b"> </p></div></div>'),ws=u('<div class="target-hint svelte-1xe9j7b"><span class="svelte-1xe9j7b"> </span> <strong class="svelte-1xe9j7b"> </strong></div>'),ks=u('<button class="item-card svelte-1xe9j7b"><img width="72" height="72" class="svelte-1xe9j7b"/> <span class="svelte-1xe9j7b"> </span></button>'),Ps=u('<!> <!> <!> <!> <div class="items-grid svelte-1xe9j7b"></div> <div class="score-bar svelte-1xe9j7b"><span class="svelte-1xe9j7b"> </span> <span class="svelte-1xe9j7b"> </span></div>',1),ys=u('<div class="celebration svelte-1xe9j7b"><span class="celebration-emoji svelte-1xe9j7b">ðŸŽ‰</span> <span class="celebration-text svelte-1xe9j7b"> </span></div>'),Is=u(`<!> <div class="pecs-page svelte-1xe9j7b"><header class="app-header svelte-1xe9j7b"><button class="back-btn svelte-1xe9j7b"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" class="svelte-1xe9j7b"><path d="M15 18l-6-6 6-6" class="svelte-1xe9j7b"></path></svg></button> <h1 class="svelte-1xe9j7b"> </h1></header> <div class="phase-bar svelte-1xe9j7b"></div> <p class="phase-desc svelte-1xe9j7b"> </p> <!> <!> <footer class="credit svelte-1xe9j7b">Pictograms: <a href="https://arasaac.org" target="_blank" rel="noopener" class="svelte-1xe9j7b">ARASAAC</a> â€” CC BY-NC-SA 3.0
    Â· Based on PECSÂ® methodology by Frost &amp; Bondy (1994). PECSÂ® is a trademark of Pyramid Educational Consultants.</footer></div>`,1);function zs(Me,Ee){Xe(Ee,!0);const f=()=>ts(os,"$t",Te),[Te,We]=as();let o=g(1),D=g(ue([])),Z=g(!0),z=g(null),b=g(ue([])),ee=g(!1),Y=g(0),G=g(0),N=g(null),se=g(!1),R=g(null),J=g(null),L=g(null),F=g(ue({}));const xe={1:{label:"pecs.phase1",desc:"pecs.phase1_desc"},2:{label:"pecs.phase2",desc:"pecs.phase2_desc"},3:{label:"pecs.phase3",desc:"pecs.phase3_desc"},4:{label:"pecs.phase4",desc:"pecs.phase4_desc"},5:{label:"pecs.phase5",desc:"pecs.phase5_desc"},6:{label:"pecs.phase6",desc:"pecs.phase6_desc"}},Be=["cookie","ball","juice","car","book","banana","puzzle","swing","bubbles","music","water","apple"],Ke=["dog","cat","bird","flower","rain","sun","tree","fish"];Ze(()=>{ge(),Oe()});async function Oe(){const s=be(Ae);if(s){const r=await cs(s,"pecs-trainer");r?.phaseProgress&&l(F,r.phaseProgress,!0)}}async function De(){const s=be(Ae);s&&await vs(s,"pecs-trainer",{phaseProgress:e(F)})}async function ge(){l(Z,!0);const s=be(is),p=(e(o)===6?Ke:Be).slice(0,e(o)<=2?4:e(o)<=4?8:12),j=s==="sv"?await ns(p):null,I=await Promise.all(p.map(async(h,$)=>{const B=await X(h,"en"),M=j?j[$].sv:h;return B[0]?{id:B[0].id,url:B[0].url,word:M}:null}));if(l(D,I.filter(Boolean),!0),e(o)>=4){const h=await X("I want",s);h[0]&&l(R,{id:h[0].id,url:h[0].url,word:"I want"},!0)}if(e(o)===6){const h=await X("I see",s),$=await X("I hear",s);h[0]&&l(J,{id:h[0].id,url:h[0].url,word:"I see"},!0),$[0]&&l(L,{id:$[0].id,url:$[0].url,word:"I hear"},!0)}e(o)>=2&&l(N,e(D)[Math.floor(Math.random()*e(D).length)]||null,!0),l(b,[],!0),l(Z,!1)}function Ne(s){Se(Y),e(o)===1?H(s):e(o)===2?(l(z,s,!0),l(se,!0)):e(o)===3?e(N)&&s.word===e(N).word?H(s):(V(f()("pecs.try_again")),l(N,e(D)[Math.floor(Math.random()*e(D).length)]||null,!0)):e(o)===4?l(b,[...e(b),s],!0):e(o)===5?(l(b,e(R)?[e(R),s]:[s],!0),me(),H(s)):e(o)===6&&l(b,[...e(b),s],!0)}function ae(s){l(b,[s,...e(b).filter(r=>r.word!==s.word)],!0)}function me(){const s=e(b).map(r=>r.word).join(" ");V(s)}function Re(){e(b).length>0&&(me(),H(e(b)[e(b).length-1]),l(b,[],!0))}function je(){e(z)&&(H(e(z)),l(z,null),l(se,!1))}function H(s){Se(G),e(F)[e(o)]={trials:e(Y),successes:e(G)},De(),V(s.word+"! "+f()("pecs.great")),l(ee,!0),setTimeout(()=>{l(ee,!1)},1500)}function ze(s){l(o,s,!0),l(Y,0),l(G,0),ge()}var we=Is(),ke=_e(we);ls(ke,{appId:"pecs-trainer",titleKey:"app.pecs_trainer",purposeKey:"welcome.pecsTrainer.purpose",howKey:"welcome.pecsTrainer.how",goalKey:"welcome.pecsTrainer.goal",icon:"ðŸ”„"});var Pe=n(ke,2),te=t(Pe),re=t(te),ye=n(re,2),Fe=t(ye);a(ye),a(te);var le=n(te,2);fe(le,20,()=>[1,2,3,4,5,6],he,(s,r)=>{var p=ds();let j;var I=t(p),h=t(I,!0);a(I);var $=n(I,2);{var B=M=>{var ie=ps();d(M,ie)};y($,M=>{e(F)[r]?.successes>=5&&M(B)})}a(p),m(()=>{j=ss(p,1,"phase-btn svelte-1xe9j7b",null,j,{active:e(o)===r,completed:e(F)[r]?.successes>=5}),x(h,r)}),A("click",p,()=>ze(r)),d(s,p)}),a(le);var oe=n(le,2),He=t(oe,!0);a(oe);var Ie=n(oe,2);{var qe=s=>{var r=us();d(s,r)},Ye=s=>{var r=Ps(),p=_e(r);{var j=c=>{var i=bs(),v=t(i),w=t(v);a(v),a(i),m(_=>x(w,`â“ ${_??""}`),[()=>f()("pecs.what_want")]),d(c,i)};y(p,c=>{e(o)===5&&c(j)})}var I=n(p,2);{var h=c=>{var i=ms(),v=t(i);{var w=k=>{var P=_s(),T=t(P);U(2),a(P),m(()=>W(T,"src",e(R).url)),A("click",P,()=>ae(e(R))),d(k,P)};y(v,k=>{e(o)===4&&e(R)&&k(w)})}var _=n(v,2);{var E=k=>{var P=xs(),T=_e(P);{var q=O=>{var S=fs(),de=t(S);U(),a(S),m(()=>W(de,"src",e(J).url)),A("click",S,()=>ae(e(J))),d(O,S)};y(T,O=>{e(J)&&O(q)})}var Q=n(T,2);{var pe=O=>{var S=hs(),de=t(S);U(),a(S),m(()=>W(de,"src",e(L).url)),A("click",S,()=>ae(e(L))),d(O,S)};y(Q,O=>{e(L)&&O(pe)})}d(k,P)};y(_,k=>{e(o)===6&&k(E)})}var K=n(_,2);fe(K,21,()=>e(b),he,(k,P)=>{var T=gs(),q=t(T),Q=n(q,2),pe=t(Q,!0);a(Q),a(T),m(()=>{W(q,"src",e(P).url),W(q,"alt",e(P).word),x(pe,e(P).word)}),d(k,T)}),a(K);var C=n(K,2),ve=t(C);a(C),a(i),m(k=>{C.disabled=e(b).length===0,x(ve,`ðŸ”Š ${k??""}`)},[()=>f()("talk.speak_all")]),A("click",C,Re),d(c,i)};y(I,c=>{e(o)>=4&&c(h)})}var $=n(I,2);{var B=c=>{var i=js(),v=t(i),w=t(v,!0);a(v);var _=n(v,2),E=n(t(_),2),K=t(E,!0);a(E),a(_),a(i),m((C,ve)=>{x(w,C),x(K,ve)},[()=>f()("pecs.bring_to_partner"),()=>f()("pecs.tap_to_give")]),A("click",_,je),A("keydown",_,C=>{(C.key==="Enter"||C.key===" ")&&je()}),d(c,i)};y($,c=>{e(o)===2&&e(se)&&e(z)&&c(B)})}var M=n($,2);{var ie=c=>{var i=ws(),v=t(i),w=t(v);a(v);var _=n(v,2),E=t(_,!0);a(_),a(i),m(K=>{x(w,`${K??""}:`),x(E,e(N).word)},[()=>f()("pecs.find")]),d(c,i)};y(M,c=>{e(o)===3&&e(N)&&c(ie)})}var ne=n(M,2);fe(ne,21,()=>e(D),he,(c,i)=>{var v=ks(),w=t(v),_=n(w,2),E=t(_,!0);a(_),a(v),m(()=>{W(w,"src",e(i).url),W(w,"alt",e(i).word),x(E,e(i).word)}),A("click",v,()=>Ne(e(i))),Ve("focus",v,()=>V(e(i).word)),d(c,v)}),a(ne);var $e=n(ne,2),ce=t($e),Le=t(ce);a(ce);var Ce=n(ce,2),Qe=t(Ce);a(Ce),a($e),m((c,i)=>{x(Le,`${c??""}: ${e(Y)??""}`),x(Qe,`${i??""}: ${e(G)??""}`)},[()=>f()("pecs.trials"),()=>f()("pecs.correct")]),d(s,r)};y(Ie,s=>{e(Z)?s(qe):s(Ye,!1)})}var Ge=n(Ie,2);{var Je=s=>{var r=ys(),p=n(t(r),2),j=t(p,!0);a(p),a(r),m(I=>x(j,I),[()=>f()("pecs.great")]),d(s,r)};y(Ge,s=>{e(ee)&&s(Je)})}U(2),a(Pe),m((s,r,p,j)=>{W(re,"aria-label",s),x(Fe,`${r??""} â€” ${p??""}`),x(He,j)},[()=>f()("app.back"),()=>f()("pecs.title"),()=>f()(xe[e(o)].label),()=>f()(xe[e(o)].desc)]),A("click",re,()=>rs("/")),d(Me,we),es(),We()}Ue(["click","keydown"]);export{zs as component};
