import{d as Te,a as p,b as _,s as v,f as h,g as De}from"../chunks/Rl5oAaZp.js";import{ag as Le,ao as R,b as Ne,ap as Oe,s as r,ah as $,ai as Ve,aj as t,ak as s,al as a,a as e,an as qe}from"../chunks/5-o2xn5F.js";import{i as z}from"../chunks/CV8532PG.js";import{e as B,i as M}from"../chunks/CWjGmADL.js";import{t as F,a as le,f as de}from"../chunks/CYPR1nOs.js";import{r as me,s as ze}from"../chunks/mnwxxtgv.js";import{s as se}from"../chunks/tEQK-CCT.js";import{b as ue}from"../chunks/Ch1I3Fei.js";import{s as Be,a as Fe}from"../chunks/1mwIFy_z.js";import{g as Ge}from"../chunks/C7HAlxDp.js";import{t as Je}from"../chunks/D-IBFiEI.js";import{s as ie}from"../chunks/TeHBZhWf.js";import{i as Ke,j as Me,v as Qe}from"../chunks/B5a8mNDb.js";import{a as Ue,b as We}from"../chunks/CCIDKU4D.js";var Xe=h('<span class="pin-icon svelte-hmkf6r">ðŸ”’</span>'),Ye=h('<button class="profile-card svelte-hmkf6r"><span class="profile-avatar svelte-hmkf6r"> </span> <span class="profile-name svelte-hmkf6r"> </span> <!></button>'),Ze=h("<div></div>"),ea=h('<p class="pin-error svelte-hmkf6r"> </p>'),aa=h("<div></div>"),ta=h('<button class="numpad-btn svelte-hmkf6r">âŒ«</button>'),ra=h('<button class="numpad-btn svelte-hmkf6r"> </button>'),la=h('<div class="overlay svelte-hmkf6r" role="button" tabindex="-1"><div class="pin-dialog svelte-hmkf6r" role="dialog" aria-modal="true" tabindex="-1"><h2 class="svelte-hmkf6r"> </h2> <div class="pin-dots svelte-hmkf6r"></div> <!> <div class="numpad svelte-hmkf6r"></div> <button class="cancel-btn svelte-hmkf6r"> </button></div></div>'),sa=h("<button> </button>"),ia=h("<button><span> </span> </button>"),oa=h('<div class="overlay svelte-hmkf6r" role="button" tabindex="-1"><div class="create-dialog svelte-hmkf6r" role="dialog" aria-modal="true" tabindex="-1"><h2 class="svelte-hmkf6r"> </h2> <label class="field-label svelte-hmkf6r" for="profile-name"> </label> <input id="profile-name" type="text" class="text-input svelte-hmkf6r"/> <span class="field-label svelte-hmkf6r" id="avatar-label"> </span> <div class="avatar-grid svelte-hmkf6r"></div> <span class="field-label svelte-hmkf6r" id="role-label"> </span> <div class="role-grid svelte-hmkf6r"></div> <label class="field-label svelte-hmkf6r" for="profile-pin"> </label> <input id="profile-pin" type="password" maxlength="4" pattern="[0-9]*" inputmode="numeric" placeholder="â€¢â€¢â€¢â€¢" class="text-input pin-field svelte-hmkf6r"/> <div class="dialog-actions svelte-hmkf6r"><button class="cancel-btn svelte-hmkf6r"> </button> <button class="create-btn svelte-hmkf6r"> </button></div></div></div>'),na=h('<div class="profiles-page svelte-hmkf6r"><h1 class="svelte-hmkf6r"> </h1> <p class="subtitle svelte-hmkf6r"> </p> <div class="profile-grid svelte-hmkf6r"><!> <button class="profile-card new-card svelte-hmkf6r"><span class="profile-avatar svelte-hmkf6r">âž•</span> <span class="profile-name svelte-hmkf6r"> </span></button></div> <!> <!></div>');function ya(_e,he){Le(he,!0);const f=()=>Fe(Je,"$t",be),[be,ke]=Be();let oe=R(Ne([])),T=R(!1),D=R(""),G=R("ðŸ˜Š"),J=R(""),Q=R("child"),x=R(""),j=R(null),U=R(!1);const ge=["ðŸ˜Š","ðŸ¦Š","ðŸ»","ðŸ¦","ðŸ¸","ðŸŒŸ","ðŸ¦‹","ðŸ¢","ðŸ°","ðŸ¦‰","ðŸ±","ðŸ¶","ðŸŒˆ","ðŸš€","ðŸŽ¨","ðŸŽµ"],xe=[{id:"child",label:"profile.role.child",emoji:"ðŸ‘§"},{id:"parent",label:"profile.role.parent",emoji:"ðŸ‘ª"},{id:"teacher",label:"profile.role.teacher",emoji:"ðŸ‘©â€ðŸ«"},{id:"therapist",label:"profile.role.therapist",emoji:"ðŸ—£ï¸"}];Oe(()=>{ne()});async function ne(){r(oe,await Ke(),!0)}async function we(l){l.pinHash?(r(j,l,!0),r(x,""),r(U,!1)):ve(l)}function ve(l){Ue.set(l.id),We.set(l),ie(f()("profile.welcome")+" "+l.name),Ge("/")}async function ye(){if(!e(j))return;await Qe(e(j).id,e(x))?(ve(e(j)),r(j,null)):(r(U,!0),r(x,""),ie(f()("profile.wrong_pin")))}function Pe(l){e(x).length<4&&(r(x,e(x)+l),e(x).length===4&&ye())}async function je(){e(D).trim()&&(await Me(e(D).trim(),e(G),e(J)||void 0),r(D,""),r(G,"ðŸ˜Š"),r(J,""),r(Q,"child"),r(T,!1),await ne())}var W=na(),X=t(W),Ae=t(X,!0);a(X);var Y=s(X,2),Ee=t(Y,!0);a(Y);var Z=s(Y,2),fe=t(Z);B(fe,17,()=>e(oe),l=>l.id,(l,i)=>{var o=Ye(),b=t(o),V=t(b,!0);a(b);var k=s(b,2),L=t(k,!0);a(k);var C=s(k,2);{var A=E=>{var H=Xe();_(E,H)};z(C,E=>{e(i).pinHash&&E(A)})}a(o),$(()=>{v(V,e(i).avatar),v(L,e(i).name)}),p("click",o,()=>we(e(i))),F(3,o,()=>le,()=>({y:20})),_(l,o)});var ee=s(fe,2),pe=s(t(ee),2),Re=t(pe,!0);a(pe),a(ee),a(Z);var ce=s(Z,2);{var $e=l=>{var i=la(),o=t(i),b=t(o),V=t(b,!0);a(b);var k=s(b,2);B(k,20,()=>Array(4),M,(n,m,w)=>{var y=Ze();let N;$(()=>N=se(y,1,"dot svelte-hmkf6r",null,N,{filled:w<e(x).length})),_(n,y)}),a(k);var L=s(k,2);{var C=n=>{var m=ea(),w=t(m,!0);a(m),$(y=>v(w,y),[()=>f()("profile.wrong_pin")]),_(n,m)};z(L,n=>{e(U)&&n(C)})}var A=s(L,2);B(A,20,()=>["1","2","3","4","5","6","7","8","9","","0","âŒ«"],M,(n,m)=>{var w=De(),y=qe(w);{var N=d=>{var g=aa();_(d,g)},q=d=>{var g=ta();p("click",g,()=>{r(x,e(x).slice(0,-1),!0)}),_(d,g)},K=d=>{var g=ra(),O=t(g,!0);a(g),$(()=>v(O,m)),p("click",g,()=>Pe(m)),_(d,g)};z(y,d=>{m===""?d(N):m==="âŒ«"?d(q,1):d(K,!1)})}_(n,w)}),a(A);var E=s(A,2),H=t(E,!0);a(E),a(o),a(i),$((n,m)=>{v(V,n),v(H,m)},[()=>f()("profile.enter_pin"),()=>f()("app.back")]),p("click",i,()=>{r(j,null)}),p("keydown",i,n=>{n.key==="Escape"&&r(j,null)}),p("click",o,n=>n.stopPropagation()),p("keydown",o,n=>n.stopPropagation()),p("click",E,()=>{r(j,null)}),F(3,o,()=>le,()=>({y:30})),F(3,i,()=>de),_(l,i)};z(ce,l=>{e(j)&&l($e)})}var Ce=s(ce,2);{var He=l=>{var i=oa(),o=t(i),b=t(o),V=t(b,!0);a(b);var k=s(b,2),L=t(k,!0);a(k);var C=s(k,2);me(C);var A=s(C,2),E=t(A,!0);a(A);var H=s(A,2);B(H,21,()=>ge,M,(c,P)=>{var u=sa();let I;var S=t(u,!0);a(u),$(()=>{I=se(u,1,"avatar-pick svelte-hmkf6r",null,I,{selected:e(G)===e(P)}),v(S,e(P))}),p("click",u,()=>{r(G,e(P),!0)}),_(c,u)}),a(H);var n=s(H,2),m=t(n,!0);a(n);var w=s(n,2);B(w,21,()=>xe,M,(c,P)=>{var u=ia();let I;var S=t(u),ae=t(S,!0);a(S);var te=s(S);a(u),$(re=>{I=se(u,1,"role-pick svelte-hmkf6r",null,I,{selected:e(Q)===e(P).id}),v(ae,e(P).emoji),v(te,` ${re??""}`)},[()=>f()(e(P).label)]),p("click",u,()=>{r(Q,e(P).id,!0)}),_(c,u)}),a(w);var y=s(w,2),N=t(y,!0);a(y);var q=s(y,2);me(q);var K=s(q,2),d=t(K),g=t(d,!0);a(d);var O=s(d,2),Ie=t(O,!0);a(O),a(K),a(o),a(i),$((c,P,u,I,S,ae,te,re,Se)=>{v(V,c),v(L,P),ze(C,"placeholder",u),v(E,I),v(m,S),v(N,ae),v(g,te),O.disabled=re,v(Ie,Se)},[()=>f()("profile.new"),()=>f()("profile.name"),()=>f()("profile.name_placeholder"),()=>f()("profile.avatar"),()=>f()("profile.role"),()=>f()("profile.pin_optional"),()=>f()("app.back"),()=>!e(D).trim(),()=>f()("profile.create")]),p("click",i,()=>{r(T,!1)}),p("keydown",i,c=>{c.key==="Escape"&&r(T,!1)}),p("click",o,c=>c.stopPropagation()),p("keydown",o,c=>c.stopPropagation()),ue(C,()=>e(D),c=>r(D,c)),ue(q,()=>e(J),c=>r(J,c)),p("click",d,()=>{r(T,!1)}),p("click",O,je),F(3,o,()=>le,()=>({y:30})),F(3,i,()=>de),_(l,i)};z(Ce,l=>{e(T)&&l(He)})}a(W),$((l,i,o)=>{v(Ae,l),v(Ee,i),v(Re,o)},[()=>f()("profile.choose"),()=>f()("profile.choose_desc"),()=>f()("profile.new")]),p("click",ee,()=>{r(T,!0),ie(f()("profile.new"))}),_(_e,W),Ve(),ke()}Te(["click","keydown"]);export{ya as component};
