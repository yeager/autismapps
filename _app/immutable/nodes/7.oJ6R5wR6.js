import{d as $e,a as A,b as y,s as b,f as w,e as ea,t as se}from"../chunks/Rl5oAaZp.js";import{ag as aa,ao as B,b as ta,an as la,ah as k,ai as ra,a as e,ak as _,s as p,aj as r,al as t,am as sa,ar as Se}from"../chunks/5-o2xn5F.js";import{i as q}from"../chunks/CV8532PG.js";import{e as ee,i as ae}from"../chunks/CWjGmADL.js";import{s as oa,r as na}from"../chunks/mnwxxtgv.js";import{s as oe}from"../chunks/tEQK-CCT.js";import{s as ne}from"../chunks/CttGtDdq.js";import{b as ia}from"../chunks/Ch1I3Fei.js";import{s as ca,a as va}from"../chunks/1mwIFy_z.js";import{g as ua}from"../chunks/C7HAlxDp.js";import{W as ba}from"../chunks/BIf6fDbj.js";import{t as da}from"../chunks/D-IBFiEI.js";import{s as z}from"../chunks/TeHBZhWf.js";var ma=w('<button class="activity-card svelte-lr4yb3"><span class="act-emoji svelte-lr4yb3"> </span> <span class="act-label svelte-lr4yb3"> </span></button>'),_a=w('<div class="activities-grid svelte-lr4yb3"></div>'),pa=w('<button><span class="pattern-name svelte-lr4yb3"> </span> <span class="pattern-timing svelte-lr4yb3"> </span></button>'),fa=w('<div class="pattern-selector svelte-lr4yb3"></div>'),ha=w('<button class="calm-btn svelte-lr4yb3"> </button>'),ya=w('<button class="calm-btn stop svelte-lr4yb3"> </button>'),ga=w('<div class="breath-area svelte-lr4yb3"><!> <div class="breath-circle svelte-lr4yb3"><span class="breath-text svelte-lr4yb3"> </span> <span class="breath-count svelte-lr4yb3"> </span></div> <!></div>'),xa=w('<div class="pressure-area svelte-lr4yb3"><p class="pressure-hint svelte-lr4yb3"> </p> <button class="pressure-circle svelte-lr4yb3"><span class="svelte-lr4yb3"> </span></button></div>'),ka=w('<span class="playing svelte-lr4yb3">â™ª</span>'),wa=w('<button><span class="sound-emoji svelte-lr4yb3"> </span> <span class="svelte-lr4yb3"> </span> <!></button>'),Ra=w('<div class="sounds-area svelte-lr4yb3"><p class="svelte-lr4yb3"> </p> <div class="sound-grid svelte-lr4yb3"></div></div>'),Sa=w('<button class="calm-btn svelte-lr4yb3"> </button>'),Ta=w('<button class="calm-btn stop svelte-lr4yb3"> </button>'),Aa=w('<div class="colors-area svelte-lr4yb3"><!></div>'),Ca=w("<div></div>"),ja=w('<div class="grounding-area svelte-lr4yb3"><div class="ground-card svelte-lr4yb3"><span class="ground-sense svelte-lr4yb3"> </span> <h2 class="svelte-lr4yb3"> </h2> <span class="ground-count svelte-lr4yb3"> </span></div> <div class="ground-dots svelte-lr4yb3"></div> <button class="calm-btn svelte-lr4yb3"> </button> <button class="link-btn svelte-lr4yb3"> </button></div>'),Ba=w("<div></div>"),Da=w('<div class="relax-area svelte-lr4yb3"><div class="relax-card svelte-lr4yb3"><span class="relax-emoji svelte-lr4yb3">ðŸ§˜</span> <h2 class="svelte-lr4yb3"> </h2> <p class="svelte-lr4yb3"> </p></div> <div class="ground-dots svelte-lr4yb3"></div> <button class="calm-btn svelte-lr4yb3"> </button> <button class="link-btn svelte-lr4yb3"> </button></div>'),Ea=w('<button class="emergency-btn svelte-lr4yb3"> </button>'),Ga=w('<div class="stress-area svelte-lr4yb3"><h2 class="svelte-lr4yb3"> </h2> <div class="stress-emoji svelte-lr4yb3"> </div> <input type="range" min="1" max="10" step="1" class="stress-slider svelte-lr4yb3"/> <div class="stress-labels svelte-lr4yb3"><span class="svelte-lr4yb3"> </span> <span class="svelte-lr4yb3"> </span> <span class="svelte-lr4yb3"> </span></div> <p class="stress-advice svelte-lr4yb3"><!></p> <!></div>'),Ia=w('<div class="emergency-overlay svelte-lr4yb3" role="button" tabindex="-1"><div class="emergency-card svelte-lr4yb3" role="dialog" aria-modal="true" tabindex="-1"><h2 class="svelte-lr4yb3"> </h2> <p class="svelte-lr4yb3"> </p> <div class="emergency-actions svelte-lr4yb3"><button class="calm-btn svelte-lr4yb3"> </button> <button class="calm-btn svelte-lr4yb3" style="background: var(--border)"> </button></div></div></div>'),Pa=w('<!> <div class="calm-page svelte-lr4yb3"><header class="app-header svelte-lr4yb3"><button class="back-btn svelte-lr4yb3"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" class="svelte-lr4yb3"><path d="M15 18l-6-6 6-6" class="svelte-lr4yb3"></path></svg></button> <h1 class="svelte-lr4yb3"> </h1></header> <!> <!> <footer class="credit svelte-lr4yb3">Pictograms: <a href="https://arasaac.org" target="_blank" rel="noopener" class="svelte-lr4yb3">ARASAAC</a> â€” CC BY-NC-SA 3.0</footer></div>',1);function Xa(Te,Ae){aa(Ae,!0);const u=()=>va(da,"$t",Ce),[Ce,je]=ca();let E=B(null),K=B("inhale"),J=B(0),I=B(!1),X=null,te=B(1);const fe=[{id:"4-7-8",label:"calm.pattern_478",inhale:4,hold:7,exhale:8},{id:"4-4-4",label:"calm.pattern_box",inhale:4,hold:4,exhale:4},{id:"3-0-6",label:"calm.pattern_simple",inhale:3,hold:0,exhale:6},{id:"5-0-5",label:"calm.pattern_calm",inhale:5,hold:0,exhale:5}];let Y=B(ta(fe[0])),le=B(!1),H=B(80),L=B(null),f=null,U=[],F=B(3),W=B(!1);const Be={1:"ðŸ˜Š",2:"ðŸ™‚",3:"ðŸ˜",4:"ðŸ˜•",5:"ðŸ˜Ÿ",6:"ðŸ˜°",7:"ðŸ˜«",8:"ðŸ¤¯",9:"ðŸ˜­",10:"ðŸ’¥"};let ie=B(200),Q=B(!1),Z=null,P=B(0);const M=[{sense:"ðŸ‘€",count:5,key:"calm.grounding.see"},{sense:"ðŸ‘‚",count:4,key:"calm.grounding.hear"},{sense:"âœ‹",count:3,key:"calm.grounding.touch"},{sense:"ðŸ‘ƒ",count:2,key:"calm.grounding.smell"},{sense:"ðŸ‘…",count:1,key:"calm.grounding.taste"}];let N=B(0);const $=["calm.relax.feet","calm.relax.legs","calm.relax.stomach","calm.relax.hands","calm.relax.arms","calm.relax.shoulders","calm.relax.face"],he=[{id:"breathing",emoji:"ðŸŒ¬ï¸",label:"calm.breathing",color:"#87CEEB"},{id:"pressure",emoji:"ðŸ«‚",label:"calm.pressure",color:"#DDA0DD"},{id:"sounds",emoji:"ðŸŽµ",label:"calm.sounds",color:"#98D8C8"},{id:"colors",emoji:"ðŸŒˆ",label:"calm.colors",color:"#FFD1DC"},{id:"grounding",emoji:"ðŸŒ",label:"calm.grounding_title",color:"#C3B1E1"},{id:"relaxation",emoji:"ðŸ§˜",label:"calm.relaxation",color:"#FFDAB9"},{id:"stress",emoji:"ðŸ“Š",label:"calm.stress_check",color:"#B0C4DE"}];function ce(s){De(),p(E,s,!0),s&&z(u()(he.find(a=>a.id===s).label))}function De(){p(I,!1),X&&clearTimeout(X),ve(),p(Q,!1),Z&&clearInterval(Z)}function Ee(){p(I,!0),ye()}function ye(){if(!e(I))return;const s=e(Y),a=(c,l)=>{if(p(J,c,!0),c<=0){l();return}X=setTimeout(()=>a(c-1,l),1e3)};p(K,"inhale"),p(te,1.6),p(J,s.inhale,!0),z(u()("calm.breathe_in")),a(s.inhale,()=>{e(I)&&(s.hold>0?(p(K,"hold"),p(J,s.hold,!0),z(u()("calm.hold")),a(s.hold,()=>{e(I)&&o()})):o())});function o(){p(K,"exhale"),p(te,1),p(J,s.exhale,!0),z(u()("calm.breathe_out")),a(s.exhale,()=>{e(I)&&ye()})}}function Ge(){p(I,!1),X&&clearTimeout(X),p(te,1)}function Ie(){p(le,!0);const s=()=>{e(le)&&e(H)<250&&(p(H,e(H)+2),requestAnimationFrame(s))};s();try{navigator.vibrate?.(5e3)}catch{}}function ge(){p(le,!1),p(H,80);try{navigator.vibrate?.(0)}catch{}}function Pe(s){if(ve(),p(L,s,!0),f=new AudioContext,s==="whitenoise"){const a=f.sampleRate*5,o=f.createBuffer(1,a,f.sampleRate),c=o.getChannelData(0);for(let i=0;i<a;i++)c[i]=(Math.random()*2-1)*.15;const l=f.createBufferSource();l.buffer=o,l.loop=!0;const n=f.createGain();n.gain.value=.3,l.connect(n),n.connect(f.destination),l.start(),U=[{noise:l,gain:n}]}else if(s==="rain"){const a=f.sampleRate*5,o=f.createBuffer(1,a,f.sampleRate),c=o.getChannelData(0);let l=0;for(let v=0;v<a;v++){const d=Math.random()*2-1;c[v]=(l+.02*d)/1.02,l=c[v],c[v]*=3.5}const n=f.createBufferSource();n.buffer=o,n.loop=!0;const i=f.createGain();i.gain.value=.4,n.connect(i),i.connect(f.destination),n.start(),U=[{noise:n,gain:i}]}else if(s==="heartbeat"){const a=f.createOscillator(),o=f.createGain();a.type="sine",a.frequency.value=60,o.gain.value=0,a.connect(o),o.connect(f.destination),a.start();const c=()=>{if(e(L)!=="heartbeat"||!f)return;const l=f.currentTime;o.gain.setValueAtTime(0,l),o.gain.linearRampToValueAtTime(.4,l+.05),o.gain.exponentialRampToValueAtTime(.01,l+.15),o.gain.setValueAtTime(0,l+.3),o.gain.linearRampToValueAtTime(.3,l+.35),o.gain.exponentialRampToValueAtTime(.01,l+.45),setTimeout(c,800)};c(),U=[{osc:a,gain:o}]}else if(s==="ocean"){const a=f.sampleRate*5,o=f.createBuffer(1,a,f.sampleRate),c=o.getChannelData(0);for(let R=0;R<a;R++)c[R]=Math.random()*2-1;const l=f.createBufferSource();l.buffer=o,l.loop=!0;const n=f.createBiquadFilter();n.type="lowpass",n.frequency.value=500;const i=f.createOscillator();i.frequency.value=.1;const v=f.createGain();v.gain.value=300,i.connect(v),v.connect(n.frequency),i.start();const d=f.createGain();d.gain.value=.25,l.connect(n),n.connect(d),d.connect(f.destination),l.start(),U=[{noise:l,gain:d}]}}function ve(){p(L,null),U.forEach(s=>{try{s.osc?.stop()}catch{}try{s.noise?.stop()}catch{}}),U=[],f&&(f.close(),f=null)}function Ve(){p(Q,!0),Z=setInterval(()=>{p(ie,(e(ie)+.5)%360)},50)}function qe(){p(Q,!1),Z&&clearInterval(Z)}function Fe(){e(P)<M.length-1&&(Se(P),z(u()(M[e(P)].key)))}function Me(){p(P,0)}function Ne(){e(N)<$.length-1&&(Se(N),z(u()($[e(N)])))}function Oe(){p(N,0)}var xe=Pa(),ke=la(xe);ba(ke,{appId:"calm-room",titleKey:"app.calm_room",purposeKey:"welcome.calmRoom.purpose",howKey:"welcome.calmRoom.how",goalKey:"welcome.calmRoom.goal",icon:"ðŸ§˜"});var ue=_(ke,2),be=r(ue),de=r(be),we=_(de,2),ze=r(we,!0);t(we),t(be);var Re=_(be,2);{var Ke=s=>{var a=_a();ee(a,21,()=>he,ae,(o,c)=>{var l=ma(),n=r(l),i=r(n,!0);t(n);var v=_(n,2),d=r(v,!0);t(v),t(l),k(R=>{ne(l,`background: ${e(c).color??""}20; border-color: ${e(c).color??""}`),b(i,e(c).emoji),b(d,R)},[()=>u()(e(c).label)]),A("click",l,()=>ce(e(c).id)),y(o,l)}),t(a),y(s,a)},He=s=>{var a=ga(),o=r(a);{var c=m=>{var g=fa();ee(g,21,()=>fe,ae,(T,h)=>{var j=pa();let O;var V=r(j),me=r(V,!0);t(V);var re=_(V,2),_e=r(re);t(re),t(j),k(x=>{O=oe(j,1,"pattern-btn svelte-lr4yb3",null,O,{active:e(Y).id===e(h).id}),b(me,x),b(_e,`${e(h).inhale??""}-${e(h).hold??""}-${e(h).exhale??""}`)},[()=>u()(e(h).label)]),A("click",j,()=>{p(Y,e(h),!0)}),y(T,j)}),t(g),y(m,g)};q(o,m=>{e(I)||m(c)})}var l=_(o,2),n=r(l),i=r(n,!0);t(n);var v=_(n,2),d=r(v,!0);t(v),t(l);var R=_(l,2);{var S=m=>{var g=ha(),T=r(g,!0);t(g),k(h=>b(T,h),[()=>u()("calm.start")]),A("click",g,Ee),y(m,g)},D=m=>{var g=ya(),T=r(g,!0);t(g),k(h=>b(T,h),[()=>u()("calm.stop")]),A("click",g,Ge),y(m,g)};q(R,m=>{e(I)?m(D,!1):m(S)})}t(a),k(m=>{ne(l,`transform: scale(${e(te)??""}); transition: transform ${e(K)==="inhale"?e(Y).inhale+"s":e(K)==="exhale"?e(Y).exhale+"s":"0s"} ease-in-out`),b(i,m),b(d,e(J))},[()=>u()("calm."+e(K))]),y(s,a)},Le=s=>{var a=xa(),o=r(a),c=r(o,!0);t(o);var l=_(o,2),n=r(l),i=r(n,!0);t(n),t(l),t(a),k(v=>{b(c,v),ne(l,`width: ${e(H)??""}px; height: ${e(H)??""}px`),b(i,e(le)?"ðŸ«‚":"ðŸ‘†")},[()=>u()("calm.hold_press")]),A("pointerdown",l,Ie),A("pointerup",l,ge),ea("pointerleave",l,ge),y(s,a)},Ue=s=>{var a=Ra(),o=r(a),c=r(o,!0);t(o);var l=_(o,2);ee(l,20,()=>[{id:"whitenoise",emoji:"ðŸ“»",label:"calm.sound.whitenoise"},{id:"rain",emoji:"ðŸŒ§ï¸",label:"calm.sound.rain"},{id:"heartbeat",emoji:"ðŸ’“",label:"calm.sound.heartbeat"},{id:"ocean",emoji:"ðŸŒŠ",label:"calm.sound.ocean"}],ae,(n,i)=>{var v=wa();let d;var R=r(v),S=r(R,!0);t(R);var D=_(R,2),m=r(D,!0);t(D);var g=_(D,2);{var T=h=>{var j=ka();y(h,j)};q(g,h=>{e(L)===i.id&&h(T)})}t(v),k(h=>{d=oe(v,1,"sound-card svelte-lr4yb3",null,d,{active:e(L)===i.id}),b(S,i.emoji),b(m,h)},[()=>u()(i.label)]),A("click",v,()=>e(L)===i.id?ve():Pe(i.id)),y(n,v)}),t(l),t(a),k(n=>b(c,n),[()=>u()("calm.choose_sound")]),y(s,a)},We=s=>{var a=Aa(),o=r(a);{var c=n=>{var i=Sa(),v=r(i,!0);t(i),k(d=>b(v,d),[()=>u()("calm.start")]),A("click",i,Ve),y(n,i)},l=n=>{var i=Ta(),v=r(i,!0);t(i),k(d=>b(v,d),[()=>u()("calm.stop")]),A("click",i,qe),y(n,i)};q(o,n=>{e(Q)?n(l,!1):n(c)})}t(a),y(s,a)},Je=s=>{var a=ja(),o=r(a),c=r(o),l=r(c,!0);t(c);var n=_(c,2),i=r(n,!0);t(n);var v=_(n,2),d=r(v,!0);t(v),t(o);var R=_(o,2);ee(R,21,()=>M,ae,(T,h,j)=>{var O=Ca();let V;k(()=>V=oe(O,1,"gdot svelte-lr4yb3",null,V,{active:j<=e(P)})),y(T,O)}),t(R);var S=_(R,2),D=r(S,!0);t(S);var m=_(S,2),g=r(m,!0);t(m),t(a),k((T,h,j)=>{b(l,M[e(P)].sense),b(i,T),b(d,M[e(P)].count),S.disabled=e(P)>=M.length-1,b(D,h),b(g,j)},[()=>u()(M[e(P)].key),()=>u()("calm.next"),()=>u()("calm.restart")]),A("click",S,Fe),A("click",m,Me),y(s,a)},Xe=s=>{var a=Da(),o=r(a),c=_(r(o),2),l=r(c,!0);t(c);var n=_(c,2),i=r(n,!0);t(n),t(o);var v=_(o,2);ee(v,21,()=>$,ae,(m,g,T)=>{var h=Ba();let j;k(()=>j=oe(h,1,"gdot svelte-lr4yb3",null,j,{active:T<=e(N)})),y(m,h)}),t(v);var d=_(v,2),R=r(d,!0);t(d);var S=_(d,2),D=r(S,!0);t(S),t(a),k((m,g,T,h)=>{b(l,m),b(i,g),d.disabled=e(N)>=$.length-1,b(R,T),b(D,h)},[()=>u()($[e(N)]),()=>u()("calm.relax_instruction"),()=>u()("calm.next"),()=>u()("calm.restart")]),A("click",d,Ne),A("click",S,Oe),y(s,a)},Ye=s=>{var a=Ga(),o=r(a),c=r(o,!0);t(o);var l=_(o,2),n=r(l,!0);t(l);var i=_(l,2);na(i);var v=_(i,2),d=r(v),R=r(d,!0);t(d);var S=_(d,2),D=r(S,!0);t(S);var m=_(S,2),g=r(m,!0);t(m),t(v);var T=_(v,2),h=r(T);{var j=x=>{var C=se();k(G=>b(C,G),[()=>u()("calm.advice_low")]),y(x,C)},O=x=>{var C=se();k(G=>b(C,G),[()=>u()("calm.advice_medium")]),y(x,C)},V=x=>{var C=se();k(G=>b(C,G),[()=>u()("calm.advice_high")]),y(x,C)},me=x=>{var C=se();k(G=>b(C,G),[()=>u()("calm.advice_critical")]),y(x,C)};q(h,x=>{e(F)<=3?x(j):e(F)<=5?x(O,1):e(F)<=7?x(V,2):x(me,!1)})}t(T);var re=_(T,2);{var _e=x=>{var C=Ea(),G=r(C);t(C),k(pe=>b(G,`ðŸ†˜ ${pe??""}`),[()=>u()("calm.need_help_now")]),A("click",C,()=>{p(W,!0),z(u()("calm.you_are_safe"))}),y(x,C)};q(re,x=>{e(F)>=7&&x(_e)})}t(a),k((x,C,G,pe)=>{b(c,x),b(n,Be[e(F)]||"ðŸ˜"),b(R,C),b(D,G),b(g,pe)},[()=>u()("calm.how_stressed"),()=>u()("calm.stress_calm"),()=>u()("calm.stress_medium"),()=>u()("calm.stress_overload")]),ia(i,()=>e(F),x=>p(F,x)),y(s,a)};q(Re,s=>{e(E)?e(E)==="breathing"?s(He,1):e(E)==="pressure"?s(Le,2):e(E)==="sounds"?s(Ue,3):e(E)==="colors"?s(We,4):e(E)==="grounding"?s(Je,5):e(E)==="relaxation"?s(Xe,6):e(E)==="stress"&&s(Ye,7):s(Ke)})}var Qe=_(Re,2);{var Ze=s=>{var a=Ia(),o=r(a),c=r(o),l=r(c);t(c);var n=_(c,2),i=r(n,!0);t(n);var v=_(n,2),d=r(v),R=r(d);t(d);var S=_(d,2),D=r(S,!0);t(S),t(v),t(o),t(a),k((m,g,T,h)=>{b(l,`ðŸ’™ ${m??""}`),b(i,g),b(R,`ðŸ« ${T??""}`),b(D,h)},[()=>u()("calm.you_are_safe"),()=>u()("calm.emergency_msg"),()=>u()("calm.breathing"),()=>u()("calm.im_ok")]),A("click",a,()=>{p(W,!1)}),A("keydown",a,m=>{m.key==="Escape"&&p(W,!1)}),A("click",o,m=>m.stopPropagation()),A("keydown",o,m=>m.stopPropagation()),A("click",d,()=>{p(W,!1),ce("breathing")}),A("click",S,()=>{p(W,!1)}),y(s,a)};q(Qe,s=>{e(W)&&s(Ze)})}sa(2),t(ue),k((s,a)=>{ne(ue,e(E)==="colors"&&e(Q)?`background: hsl(${e(ie)}, 60%, 85%)`:""),oa(de,"aria-label",s),b(ze,a)},[()=>u()("app.back"),()=>u()("calm.title")]),A("click",de,()=>e(E)?ce(null):ua("/")),y(Te,xe),ra(),je()}$e(["click","pointerdown","pointerup","keydown"]);export{Xa as component};
